<!DOCTYPE html>
<html lang="en">

<head data-page="My Wishlist" data-img="<%= user.userImg %>" data-fullname="<%= user.fullname %>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js"></script>
    <link rel="shortcut icon" href="/assets/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/output.css">
    <link rel="stylesheet" href="/css/common/loader.css">
    <link rel="stylesheet" href="/css/user.css">
    <link rel="stylesheet" href="/css/users/my-wishlist.css">
    <link rel="stylesheet" href="/css/common/stars.css">
    <link rel="stylesheet" href="/css/common/logout.css">
    <link rel="stylesheet" href="/css/common/empty.css">
    <link rel="stylesheet" href="/css/common/footer.css">
    <title>Your Wishlist - QuickCart</title>
</head>

<body>
    <div class="nav-con">
        <div class="left">
            <i class="fa-solid fa-bars"></i>
        </div>
        <div class="center">
            <div class="logo-text">QuickCart</div>
            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 3H6L9 15H19L22 6H7" stroke="#64B6AC" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
                <circle cx="10" cy="18" r="2" stroke="#CCD6F6" stroke-width="2" fill="none" />
                <circle cx="18" cy="18" r="2" stroke="#CCD6F6" stroke-width="2" fill="none" />
                <g class="tag">
                    <path d="M15 5L18 8L16 10L13 7L15 5Z" stroke-linecap="round" stroke-linejoin="round" fill="#FF6F00"
                        stroke="#FF6F00" stroke-width="1.5" />
                    <circle cx="15" cy="7" r="0.8" fill="#0A192F" />
                </g>
            </svg>
        </div>
    </div>

    <div class="main-container">
        <div class="side-nav-con">
        </div>
        <div class="content-con">
            <div class="heading">Your Wishlist</div>
            <% if(products.length!==0) { %>
            <div class="tab-bar-con">
                <div class="products-count">
                    I Hope You Will Get <%= products.length==1 ? "That" : "These" %> "<%= products.length %>" <%=
                                    products.length==1 ? "Product" : "Products" %> As Soon As Possible
                </div>
            </div>
            <% } %>
            <div class="products-list-con">
                <% if(products.length!==0) { %>
                <% products.forEach(product=> { %>
                <a class="main-card" href="/shop/<%= slugify(product.proName, {lower: true}) %>-<%= product._id %>">
                    <div class="cards">
                        <div class="product-img" data-productid="<%= product._id %>">
                            <img src="<%= product.image %>" alt="">
                        </div>
                        <div class="pro-details">
                            <div>
                                <div class="pro-name">
                                    <%= product.proName %>
                                </div>
                                <div class="pro-price-con">
                                    <div>
                                        <div class="pro-price">Rs.
                                            <%= product.proPrice %>
                                        </div>
                                        <div class="before-dis">Rs.
                                            <%= product.proOrignalPrice %>
                                        </div>
                                        <div class="discount">-
                                            <%= product.proDiscount %>%
                                        </div>
                                    </div>
                                </div>
                                <div class="pro-info">
                                    <div class="another">
                                        <div class="pro-buyer">
                                            <%= product.proBuyer %> Sold
                                        </div>
                                        <div class="pro-rate">
                                            <div class="stars-con">
                                                <div class="stars"
                                                    style="font-size:1.3em;--rating: <%= ((product.proRating/5)*100) %>%;">
                                                </div>
                                            </div>
                                            <span class="pro-revs">(<%= product.proNoOfReviews %>)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="customizeable">
                                    <% if (product.customization) { %>
                                    Customizeable
                                    <% } else { %>
                                    Non Customizeable
                                    <% } %>
                                </div>
                                <div
                                    style="width: 100%; display: flex; align-items: center; justify-content: space-between;">
                                    <button class="add-cart-btn mobile-cart-btn" onclick="handleButtonClick(event)">
                                        Add To Cart</button>
                                    <svg class="trash-btn" title="Remove Product From Wishlist"
                                        onclick="handleButtonClick(event)" xmlns="http://www.w3.org/2000/svg"
                                        height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
                                        <path
                                            d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z" />
                                    </svg>
                                </div>
                            </div>
                            <div class="pro-price-con">
                                <div>
                                    <div class="pro-price">Rs.
                                        <%= product.proPrice %>
                                    </div>
                                    <div class="before-dis">Rs.
                                        <%= product.proOrignalPrice %>
                                    </div>
                                    <div class="discount">-
                                        <%= product.proDiscount %>%
                                    </div>
                                </div>
                                <button class="cart-btn add-cart-btn" onclick="handleButtonClick(event)">
                                    Add To Cart</button>
                            </div>
                        </div>
                    </div>
                </a>
                <% }) %>
                <% } else { %>
                <div class="empty-con">
                    <img src="/assets/wish-list.png" alt="Empty Wishlist" />
                    <h3>Your Wishlist is Empty</h3>
                    <p>Start adding your favorite products!</p>
                    <a href="/shop" class="explore-btn">Explore Products</a>
                </div>
                <% } %>
            </div>
        </div>
    </div>


    <script src="/js/common/at-start.js"></script>
    <script>
        function handleButtonClick(event) {
            event.stopPropagation();
            event.preventDefault();
        }
        document.querySelectorAll(".add-cart-btn").forEach(btn => {
            btn.addEventListener("click", async () => {
                const proID = btn.closest(".cards").querySelector(".product-img").dataset.productid;
                const res = await fetch('/shop/add-to-cart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        proID
                    }),
                });
                const res1 = await res.json();
                if (res1.success) {
                    window.location.href = `/shop/cart`;
                }
            })
        })
        document.querySelectorAll(".trash-btn").forEach(btn => {
            btn.addEventListener("click", async () => {
                const proID = btn.closest(".cards").querySelector(".product-img").dataset.productid;
                const res = await fetch('/shop/remove-from-wishlist', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        proID
                    }),
                });
                const res1 = await res.json();
                if (res1.success) {
                    window.location.reload();
                }
            })
        })
    </script>
    <script src="/js/user.js"></script>
    <script src="/js/common/user-sidebar.js"></script>
    <script src="/js/common/footer.js"></script>
    <script src="/js/common/at-last.js"></script>
</body>

</html>